function [rts] = newton_safe(funcd, x_guess, x1, x2, xacc )MAXIT = 100;[fl, df] = funcd( x1 );[fh, df] = funcd( x2 );if ( fl < 0 )    xl = x1;    xh = x2;else    xh = x1;    xl = x2;endrts = x_guess;dxold = abs( x2 - x1 );dx = dxold;[f ,df] = funcd( rts );for j = 1:MAXIT    if ( ((rts - xh) * df - f) * ((rts - xl) * df - f) >= 0 |...            abs( 2.0 * f ) > abs( dxold * df ) )        dxold = dx;        dx = 0.5 * ( xh - xl );        rts = xl + dx;        if ( xl == rts )            return;        end    else        dxold = dx;        dx = f / df;        temp = rts;        rts = rts - dx;        if ( temp == rts )            return;        end    end    if ( abs( dx ) < xacc )        return;    end    [f,df] = funcd( rts );    if ( f < 0 )        xl = rts;    else        xh = rts;    endendreturn;